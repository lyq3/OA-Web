<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>快速发文</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="../../css/public.css" media="all" />
    <style>
        .top-btn {
            /*margin-top: 10px;*/
            margin-left: 10px;
            /*float: right;*/
        }
    </style>
</head>
<body style="overflow-x: hidden">
<!--保存按钮-->
<div style="float: right;margin-right: 20px;position:fixed;right: 20px;top: 50px;z-index: 9999">
    <button id="saveOfficial" class="layui-btn layui-btn-normal top-btn">保存</button>
    <button id="commitOfficial" class="layui-btn top-btn">提交</button>
</div>
<!--<div style="margin-left: 20px">模板选择<hr style="margin: 0" class="layui-bg-blue"></div>-->
<blockquote class="layui-elem-quote" style="margin-left: 20px;line-height: 10px;margin-top: 5px">模板选择</blockquote>
<!--表单1-->
<div class="layui-form layui-form-pane" >
    <div class="layui-row layui-col-space20" style="margin-top: 5px;margin-left: 20px">
        <div class="layui-col-md4" >
            <div class="layui-form-item">
                <label class="layui-form-label" >公文模板</label>
                <div class="layui-input-block">
                    <select name="mbmc" lay-verify="" >
                        <option value="城关区净土农业发展有限公司">城&nbsp;关&nbsp;区&nbsp;净&nbsp;土&nbsp;农&nbsp;业&nbsp;发&nbsp;展&nbsp;有&nbsp;限&nbsp;公&nbsp;司</option>
                        <option value="城关区安全生产委员会">城&nbsp;关&nbsp;区&nbsp;安&nbsp;全&nbsp;生&nbsp;产&nbsp;委&nbsp;员&nbsp;会</option>
                        <option value="城关区文广局简报">城&nbsp;关&nbsp;区&nbsp;文&nbsp;广&nbsp;局&nbsp;简&nbsp;报</option>
                        <option value="城关区文广局文件">城&nbsp;关&nbsp;区&nbsp;文&nbsp;广&nbsp;局&nbsp;文&nbsp;件</option>
                        <option value="科技局文件">科&nbsp;技&nbsp;局&nbsp;文&nbsp;件</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="layui-form-item">
                <label class="layui-form-label" >版记模板</label>
                <div class="layui-input-block">
                    <select name="city" lay-verify="" >
                        <option value="0">版记模板</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space20" style="margin-top: 5px;margin-left: 20px">
        <div class="layui-col-md4">
            <div class="layui-form-item" >
                <label class="layui-form-label" >分发对象</label>
                <div class="layui-input-block">
                    <!--<div style="border: 1px solid #E6E6E6;width: 100%"></div>-->
                    <input id="ffdx" readonly="readonly" type="text" name="title" required lay-verify="" placeholder="单击选择发送人" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="layui-form-item ">
                <label class="layui-form-label" >其他</label>
                <div class="layui-input-block" style="border: 1px solid #E6E6E6">
                    <input type="checkbox" name="" title="短信提醒" lay-skin="primary">
                    <div id="blsx" class="layui-inline">
                        <input  type="checkbox" name="blsx" value="1" title="办理时限" lay-skin="primary">
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md4" id = "hideRqfw" style="display: none">
            <div class="layui-form-item ">
                <div class="layui-inline">
                    <label class="layui-form-label">日期范围</label>
                    <div class="layui-input-inline">
                        <input type="text" class="layui-input" id="rqfw" placeholder=" - ">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <button id="createEdit3" style="height: 0;width: 0" lay-submit lay-filter="createEdit3" ></button>
</div>


<blockquote class="layui-elem-quote" style="margin-left: 20px;line-height: 10px">条件填写</blockquote>


<!--正文-->
<div class="layui-form" style="margin: 0 100px;padding-right:5px;border-left: 1px solid silver;border-right: 1px solid silver">
    <!--标题-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md2" ></div>
        <div class="layui-col-md6" >
            <div >
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <select name="city" lay-verify="" >
                            <option value="0">版记模板</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="layui-col-md4" ></div>-->
    </div>
    <!--文种-->
    <div class="layui-row layui-col-space1">
        <div class="layui-col-md3" >
            <label class="layui-form-label" ><span style="color: red">* </span>文　种</label>
            <div class="layui-input-block">
                <select name="wz" lay-verify="" >
                    <option value="0"> 通知</option>
                    <option value="1"> 请示</option>
                    <option value="2"> 批复</option>
                    <option value="3"> 申请</option>
                    <option value="4"> 决定</option>
                    <option value="5"> 会议</option>
                    <option value="6"> 决定</option>
                    <option value="7"> 通报</option>
                    <option value="8"> 函</option>
                    <option value="9"> 简报</option>
                </select>
            </div>
        </div>
        <div class="layui-col-md3" >
            <label class="layui-form-label" ><span style="color: red">* </span>发文字号</label>
            <div class="layui-input-block">
                <select name="fwdw" lay-verify="" >
                    <option value="城工信发文 [2018]">城工信发文</option>>
                    <option value="城委办 [2018]">城委办</option>>
                    <option value="城人大办 [2018]">城人大办</option>>
                    <option value="城人大办 [2018]">城人大办</option>>
                    <option value="城党组发 [2018]">城党组发</option>>
                    <option value="城政 [2018]">城政</option>>
                    <option value="城政复 [2018]">城政复</option>>
                </select>
            </div>
        </div>

        <div class="layui-col-md4">
            <label class="layui-form-label">日期</label>
            <div class="layui-input-inline">
                <input type="text" name="whrq" class="layui-input" id="whrq" placeholder="请选择日期">
            </div>
        </div>
        <div class="layui-col-md2" >
            <label class="layui-form-label">号</label>
            <div class="layui-input-block">
                <input type="text" name="wh" required lay-verify="number" value="1" autocomplete="off" class="layui-input">
            </div>
        </div>
        <!--<div class="layui-col-md4" >-->
        <!--<label class="layui-form-label" >其他</label>-->
        <!--<div class="layui-input-block">-->
        <!--<select name="city" lay-verify="required" >-->
        <!--<option value="0">版记模板</option>-->
        <!--</select>-->
        <!--</div>-->
        <!--</div>-->
    </div>

    <!--签发人-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md4" >
            <label class="layui-form-label" >签发人</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" value="管理员" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-col-md4" >
            <label class="layui-form-label" ><span style="color: red">* </span>签发日期</label>
            <div class="layui-input-block">
                <input type="text" class="layui-input" id="qfrq">
            </div>
        </div>
    </div>

    <!--发文意见-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md12" >
            <label class="layui-form-label" >发文意见</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="请输入发文意见" class="layui-textarea"></textarea>            </div>
        </div>
    </div>

    <!--公文标题-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md12" >
            <label class="layui-form-label" ><span style="color: red">* </span>公文标题</label>
            <div class="layui-input-block">
                <input type="text" name="gwbt" required lay-verify="" value="关于建设社会主义新农村" placeholder="输入公文标题" autocomplete="off" class="layui-input">
            </div>
        </div>
    </div>
    <!--主送机关、抄送机关-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md6" >
            <label class="layui-form-label" >主送机关</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" placeholder="输入内容" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-col-md6" >
            <label class="layui-form-label" >抄送机关</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" placeholder="输入内容" autocomplete="off" class="layui-input layui-inline">
            </div>
        </div>
    </div>
    <!--附注-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md12" >
            <label class="layui-form-label" >附注</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" placeholder="输入内容" autocomplete="off" class="layui-input">
            </div>
        </div>
    </div>

    <!--紧急程度-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md6" >
            <label class="layui-form-label" >紧急程度</label>
            <div class="layui-input-block">
                <select name="city" lay-verify="" >
                    <option value="0">非急件</option>
                    <option value="1">紧急</option>
                    <option value="2">普通</option>
                </select>
            </div>
        </div>
        <div class="layui-col-md6" >
            <label class="layui-form-label" >文件密级</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" value="无密级" autocomplete="off" class="layui-input layui-inline">
            </div>
        </div>
    </div>

    <!--拟稿人-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md6" >
            <label class="layui-form-label" >拟稿人</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" value="管理员" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-col-md6" >
            <label class="layui-form-label" >拟稿部门</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" value="管理员" autocomplete="off" class="layui-input layui-inline">
            </div>
        </div>
    </div>

    <!--起草日期-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md6" >
            <label class="layui-form-label" ><span style="color: red">* </span>起草日期</label>
            <div class="layui-input-block">
                <input type="text" class="layui-input" id="qcrq">
            </div>
        </div>
        <div class="layui-col-md6" >
            <label class="layui-form-label" >纸　张</label>
            <div class="layui-input-block">
                <input type="radio" name="zz" value="1" title="A4" checked>
                <input type="radio" name="zz" value="2" title="16K" >
            </div>
        </div>
    </div>

    <!--印发日期-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md6" >
            <label class="layui-form-label" >文印 (份数)</label>
            <div class="layui-input-block">
                <input type="text" name="title" required lay-verify="" value="0" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-col-md6" >
            <label class="layui-form-label" >印发日期</label>
            <div class="layui-input-block">
                <input type="text" class="layui-input" id="yfrq">
            </div>
        </div>
    </div>

    <!--公开属性-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md10" >
            <label class="layui-form-label" >公开属性</label>
            <div class="layui-input-block">
                <input type="radio" name="gksx" value="1" title="主动公开">
                <input type="radio" name="gksx" value="2" title="依申请公开" checked>
                <input type="radio" name="gksx" value="3" title="不予公开" checked>
            </div>
        </div>
    </div>
    <!--附件-->
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md2" >
            <label class="layui-form-label" >附件</label>
            <div class="layui-input-block">
                <button  type="button" class="layui-btn layui-btn-normal layui-btn-sm" id="sc">
                    <i class="layui-icon">&#xe67c;</i>上传附件
                </button>
            </div>
        </div>
    </div>

    <button id="createEdit2" style="height: 0;width: 0" lay-submit lay-filter="createEdit2" ></button>
</div>
<!--公文编辑区-->
<!-- 加载编辑器的容器 -->
<blockquote class="layui-elem-quote" style="margin-left: 20px;line-height: 10px;margin-bottom: 0">公文编辑</blockquote>
<button id="createEdit" class="layui-btn layui-btn-normal top-btn " lay-submit lay-filter="createEdit" style="margin:10px 0px 10px 20px">生成模板</button>
<div id="container" name="content" style="margin: 0 20px 20px 20px">　</div>
<!-- 配置文件 -->
<script type="text/javascript" src="../../plug/ueditor1.4.3/ueditor.config.js"></script>
<!-- 编辑器源码文件 -->
<script type="text/javascript" src="../../plug/ueditor1.4.3/ueditor.all.js"></script>

<script type="text/javascript">

</script>
</body>
<!--[if lt IE 9]>
<script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
<script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../layui/layui.js"></script>
<script type="text/javascript" src="../../js/main.js"></script>
<script>
    var ffdx = ''//用于存放选择的Ffdx
    layui.use(['laydate','upload','util','layer','form'], function(){
        var form = layui.form;
        var laydate = layui.laydate;
        var upload = layui.upload;
        var util = layui.util;
        var layer = layui.layer;
        var $ = layui.jquery;
        //执行
        util.fixbar({
            bar1: false
            ,click: function(type){
                console.log(type);
                if(type === 'bar1'){
                    alert('点击了bar1')
                }
            }
        });
        //签发日期
        laydate.render({
            elem: '#qfrq', //指定元素
            theme:'#1E9FFF',
            calendar: true
        });
        //起草日期
        laydate.render({
            elem: '#qcrq', //指定元素
            theme:'#1E9FFF',
            calendar: true,
            value: new Date()
        });
        //印发日期
        laydate.render({
            elem: '#yfrq', //指定元素
            theme:'#1E9FFF',
            calendar: true
        });
        //日期范围
        laydate.render({
            elem: '#rqfw'
            ,range: true
        });
        //文件日期
        laydate.render({
            elem: '#whrq',
            type: 'year'
        });
        //执行实例
        var uploadInst = upload.render({
            elem: '#sc' //绑定元素
            ,url: '/upload/' //上传接口
            ,done: function(res){
                //上传完毕回调
            }
            ,error: function(){
                //请求异常回调
            }
        });

        //保存 提交按钮单击
        $(function(){
            $("#saveOfficial").click(function(){
                layer.msg("保存成功，仅为演示");
            });
            $("#commitOfficial").click(function(){
                layer.confirm('是否提交公文?', {
                    btn: ['提交','放弃'], //按钮
                    icon : 3
                }, function(){
                    layer.msg('提交成功，仅为演示', {icon: 1});
                }, function(){
                    layer.msg('取消后会顺便将公文保存但不会提交', {
                        time: 20000, //20s后自动关闭
                        btn: ['明白了', '原来如此']
                    });
                });
            });

        })

        var edit_param1;
        var edit_param2;

        form.on('submit(createEdit3)', function(data){
            edit_param1=$.parseJSON(JSON.stringify(data.field));
            return false;
        });
        form.on('submit(createEdit2)', function(data){
            edit_param2=$.parseJSON(JSON.stringify(data.field));
            return false;
        });

        $("#createEdit").on("click",function () {
            $("#createEdit2").trigger('click');
            $("#createEdit3").trigger('click');
            //实例化编辑器
            var ue = UE.getEditor('container',{
                initialFrameHeight : 400
            });
            ue.ready(function() {
                var mbmc=edit_param1.mbmc;
                var title=edit_param2.gwbt;
                var content1=edit_param2.fwdw+"&nbsp;"+edit_param2.wh+"&nbsp;号";
                ue.setContent('<h2 style="font-size: 32px; font-weight: bold;  padding: 0px 4px 20px 0px; text-align: center; ">\n' +
                    '    <span style="color: rgb(255, 0, 0); font-family: 宋体, SimSun;">&nbsp;<strong>ल्हासा चेन्गुन जिला शुद्ध भूमि कृषि कं लिमिटेड दस्तावेज</strong></span>\n' +
                    '</h2>\n' +
                    '<h2 style="font-size: 32px; font-weight: bold;  padding: 0px 4px 50px 0px; text-align: center; margin: 0px 0px 20px;">\n' +
                    '    <span style="color: rgb(255, 0, 0); font-family: 宋体, SimSun;">&nbsp;<strong>'+mbmc+'</strong></span>\n' +
                    '</h2>\n' +
                    '<h2 style="font-size: 14px;font-weight: bold;margin-top: 10px;border-bottom: 2px solid red;text-align:center;">'+content1+'</h2>\n'+
                    '<p>\n' +
                    '    <span style="color: rgb(255, 0, 0); font-family: 宋体, SimSun;"><strong><br/></strong></span>\n' +
                    '</p>\n' +
                    '<p>\n' +
                    '    <br/>\n' +
                    '</p>\n'+
                     '<h2 style="font-size: 24px;font-weight: bold;text-align:center;">'+title+'</h2>'+
                    '<p>\n' +
                    '    <br/>\n' +
                    '</p>\n'+
                    '<p>\n' +
                    '    <br/>\n' +
                    '</p>\n'+
                    '<h2 style=""><img  src="../../images/yz.jpeg"></img></h2>'
                );
            });
        });


        //选择分发对象
        $("#ffdx").click(function(){
            layer.open({
                title:'选择分发对象',
                type: 2,
                area: ['700px', '450px'],
                fixed: false, //不固定
                maxmin: true,
                btn :['确认','取消'],
                content: './selectFfdx.html?parm='+$("#ffdx").val(),
                yes : function(index){
                    $("#ffdx").val(ffdx);
                    layer.close(index);
                }
            });
        })

        //办理时限
        $("#blsx").click(function(){
            var isCheck = $('#blsx input').is(":checked");
            if(!isCheck){
                $('#hideRqfw').css('display', 'none')
            }else {
                $('#hideRqfw').css('display', '')
            }
        })
    });

    //父子操作方法
    function addFfdx(parm) {
        ffdx = parm;
    }

</script>